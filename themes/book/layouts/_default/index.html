{{ define "main" }}
<main aria-role="main">
    <div id='calendar'></div>


    <div id="app">
      <el-calendar v-model="today">
  
        <template
        slot="dateCell"
        slot-scope="{date, data}"
        
        >
        ${data.day.split('-')[2]}} 
          <div  
          class="calendarTask"
          v-if="jsonData[data.day]" 
          v-for="item in jsonData[data.day]"
           @click="sendCustomNotification(data.day,jsonData[data.day],'info')">
           <i class="el-icon-delete"></i>
  
             <el-tag type="success">${item.task}} </el-tag>
  
          </div>
       
    
      </template>
      </el-calendar>
    </div>
  
  <script>
    
      document.addEventListener('DOMContentLoaded', function() {
        let content = "{{ $page := .Site.GetPage `/posts/日志.md` }}{{ $page.RawContent }}";

        var calendarEl = document.getElementById('calendar');
        const jsonData = parseMarkdownToJSON(content);
        console.log(jsonData);
        var calendar = new FullCalendar.Calendar(calendarEl, {
          initialView: 'dayGridMonth',
          locale: 'zh-cn',

          events:jsonData,
          headerToolbar: {
            right: 'prev,next today', // 左侧按钮，包括前一个、后一个和今天
      // center: 'title',        // 中间标题
      left:"title"
      // right: 'dayGridMonth,timeGridWeek,timeGridDay' // 右侧切换视图的按钮
    },
        });
        calendar.render();
      });


    
    // var app = new Vue({
    //   delimiters: ['${', '}}'], // 修改插值分隔符为[[]]
    //   data() {
    //     return {
    //       today: new Date(),
    //       jsonData: jsonData
    //     }
    //   },
    //   methods: {
    //     sendCustomNotification(title,message,type) {
    //       console.log(title)
    //       // 在按钮点击时触发通知，并传递消息
    //       this.$notify({
    //         title: title,
    //         message: message,
    //         type: type // 可以根据需要更改通知类型
    //       });
    //     }
    //   }
    // });
    // // 在运行时使用$mount挂载到元素
    // app.$mount('#app');
    // console.log(jsonData)
  </script>



  <h4>
     <span class="nowDate" data-unix="{{ now.Unix }}">  </span>
  </h4>
  <h4>
    <!-- 列出最新编辑的前三篇文章 -->
    {{ range first 3 (sort .Site.RegularPages "Lastmod" "desc") }}
    <!-- 显示最后编辑时间戳 -->
    <span class="LastChange" data-unix="{{ .Lastmod.Unix }}"> </span>
    编辑了
    <a href="{{ .Permalink }}"> {{ .Title }} </a>
    / {{ end }}
  </h4>
  <h4>
    {{ $totalWordCount := 0 }}

    {{ range .Site.RegularPages }}
      {{ with .Content }}
        {{ $wordCount := printf "%s" . | len }}
        {{ $totalWordCount = add $totalWordCount $wordCount }}
      {{ end }}
    {{ end }}
    博客共 {{ .Site.RegularPages | len }} 个文章, 共计 <span>{{ $totalWordCount }}</span> 字
  </h4>
  <h4>

    {{ if .Site.LastChange.After .GitInfo.AuthorDate }}
    <!-- 如果站点的最后更改时间晚于作者的最后提交日期，显示提醒消息 -->
    上次提交在
    <span class="AuthorDate" data-unix="{{ .GitInfo.AuthorDate.Unix }}"> </span>
    , 请勿忘记提交
    {{ end }}



  </h4>
  <script>
    // 在页面加载时执行的 JavaScript 代码
    window.onload = function () {
      // 更新具有 "LastChange" 类名的元素的时间戳
      updateDateTimeByElementClass("LastChange");
      // 更新具有 "AuthorDate" 类名的元素的时间戳
      updateDateTimeByElementClass("AuthorDate");
      // 更新具有 "nowDate" 类名的元素的时间戳
      updateDateTimeByElementClass("nowDate");
    };
  </script>

  
</main>
{{ end }}
